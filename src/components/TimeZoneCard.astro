---
import {
  getCurrentTimeInLosAngeles,
  formatTimeForLosAngeles,
} from "../lib/helpers";
import Card from "./Card/index.astro";
---
 
<script>
  import { onCleanup, onMount } from "solid-js";
  import { formatTimeForLosAngeles } from "../lib/helpers";

  let interval: ReturnType<typeof setInterval>;

  function updateClock() {
    const timeDisplay = document.getElementById("timeDisplay");
    const weatherIcon = document.getElementById("weatherIcon");
    const pulseDot = document.getElementById("pulseDot");
    const now = new Date();
    const hour = now.getHours();

    if (timeDisplay) {
      timeDisplay.textContent = formatTimeForLosAngeles(now);
      timeDisplay.setAttribute("datetime", now.toISOString());
    }

    // Dynamic weather icon based on time
    if (weatherIcon) {
      if (hour >= 6 && hour < 18) {
        weatherIcon.textContent = "‚òÄÔ∏è";
        weatherIcon.className = "text-2xl";
      } else if (hour >= 18 && hour < 21) {
        weatherIcon.textContent = "üåÖ";
        weatherIcon.className = "text-2xl";
      } else {
        weatherIcon.textContent = "üåô";
        weatherIcon.className = "text-2xl";
      }
    }

    // Pulsing dot animation üáπüá≠  <span id="weatherIcon" class="text-2xl">‚òÄÔ∏è</span>
    if (pulseDot) {
      pulseDot.style.animation = "pulse 2s ease-in-out infinite";
    }
  }

  onMount(() => {
    interval = setInterval(updateClock, 1000);
  });

  onCleanup(() => {
    clearInterval(interval);
  });
</script>

<Card colSpan="lg:col-span-2" rowSpan="md:row-span-2" title="Local Time:">
 <div class="text-xl md:text-lg lg:text-2xl text-neutral-100/70 flex items-center gap-3">
   
    <span>Bangkok, Thailand </span>
   
    
</div>

  <time
    datetime=""
    id="timeDisplay"
    class="text-3xl md:text-2xl lg:text-5xl flex f-bold h-full mt-3 tracking-widest"
  >
    {formatTimeForLosAngeles(getCurrentTimeInLosAngeles())}
  </time>


 
</Card>